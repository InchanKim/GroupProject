---
title: "Team 02 Project"
author: "Isabella Hundley, Admir Isnaeni, Inchan Kim, Peyton Thompson"
date: "April 20, 2018"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = F)
library(tinytex)
library(tidyverse)
library(knitr)
library(DBI)
library(scales)

source("conn.R")
source("salaryBrackets.R")
```

#Intro
Our team wanted to know how an LSU graduate's past internships affect their salary after graduation, if at all. 

#Results
###Number of Internships


###Paid or Unpaid Internships
```{r}
graduat <- tbl(conStudent,'graduation')
graduat1 <- as_data_frame(graduat)

intern <- tbl(conStudent,'internship')
intern1 <- as_data_frame(intern)

oo <- intern1 %>% inner_join(graduat1) %>% count(internshipPaid) %>% 
  filter(!is.na(internshipPaid))

paid<- tbl(conStudent,'internship') %>% inner_join(tbl(conStudent,'graduation')) %>% select(graduationId,internshipPaid)

total<- tbl(conStudent,'internship') %>% inner_join(tbl(conStudent,'graduation')) %>% select(graduationId,jobTitle,internshipPaid)%>% count(internshipPaid) %>% 
  filter(!is.na(internshipPaid))

internshipP <- paid %>% collect() 

tn <- oo %>% filter(internshipPaid== "no")
ty <- oo %>% filter(internshipPaid== "yes")
```
As we have stated previously, of all of the LSU graduates from 2017, `r length(unique(intern1$graduationId))` had internships while completing their degree.  

From this number there is a total of `r oo[1,2]` unpaid internships, and `r oo[2,2]` paid internships taken by students that graduated in 2017.  

In this analysis we will find out about the correlation between paid and unpaid internship on the starting salaries for graduated students in 2017.  
```{r}
paidcol <- tbl(conStudent,'internship') %>% inner_join(tbl(conStudent,'graduation')) %>% select(graduationId,jobTitle,internshipPaid)%>% count(internshipPaid) %>% 
  filter(!is.na(internshipPaid)) %>% collect() %>% 
  ggplot()+
  geom_col(aes(internshipPaid, n))
paidcol
```

```{r}
kk <- paid %>% collect() %>% right_join(yy, by = "graduationId") %>%  filter(!is.na(internshipPaid)) %>% select(salaryBracket, internshipPaid) %>% count(salaryBracket, internshipPaid)%>% mutate(percentage = round(n/2099, digits = 3))
```
From the dataset we found out that `r sum(kk$n)` get a job right after graduation. The distribution based on the salary bracket is :

* `r kk[1,3]` graduates with unpaid internships, and `r kk[2,3]` graduates with paid internships got high starting salaries.
* `r kk[5,3]` graduates with unpaid internship, and `r kk[6,3]` graduates with paid internship got medium starting salaries.
* `r kk[3,3]` graduates with unpaid internship, and `r kk[4,3]` graduates with paid internship got low starting salaries.

```{r}
paidbar <- paid %>% collect() %>% right_join(yy, by = "graduationId") %>%  filter(!is.na(internshipPaid)) %>% 
  ggplot() + geom_bar(aes(x = internshipPaid, fill = salaryBracket), position = "dodge") + scale_fill_discrete(guide_legend(title = "Salary Bracket")) 
paidbar
```
Based on data and graph above we can coclude that paid internship have highly positive correlation on starting salary with the highest percentage of `r kk[6,4]` for high starting salary, and second highest of `r kk[4,4]` for medium starting salary.  

###Employer Loyalty


###How LSU Graduates Stack Up
To put everything in perspective, we wanted to compare the starting salaries of LSU graduates to that of the average college graduate in the US. To do this, we used a dataset from *The Wall Street Journal* (WSJ) that included the median starting salaries of college graduates by major: http://online.wsj.com/public/resources/documents/info-Degrees_that_Pay_you_Back-sort.html.  
Of the `r nrow(kaggle)` majors listed in the WSJ dataset, only `r nrow(kaggle) - nrow(notIn)` matched up with the majors of the LSU graduates who went into the workforce after graduation. Some of the major names had to be adjusted to match up properly to the WSJ dataset.  

The changes that were made:

LSU | WSJ
---------------------------------------- | --------------------------------------
biological sciences | biology
management | business management
theatre | drama
fine arts - art history | art history
construction management | construction
forestry - forest management | forestry
information systems and decision sciences | management information systems (mis)
mathematics | math
nutrition and food sciences | nutrition
international studies | international relations

Also :

* `r grep("edu", majorList$majorName, value = T)` were changed to **education**
* agricultural business, agricultural economics were changed to **agriculture**
* `r grep("mass communication", majorList$majorName, value = T)` were changed to **mass communication**

```{r}
salaryPlot
```

There are `r length(unique(all$majorName))` majors listed in this graph, so it might be hard to tell which is which. We've broken it down into two graphs instead.

```{r}
higherPlot
lowerPlot
```

As you can see, there are `r length(unique(higher$majorName))` LSU majors that pay equal to or higher than the national median and `r length(unique(lower$majorName))` LSU majors that pay less than the national median.

Some majors have a wider range of salaries than others, so we have included box-and-whisker plots at the end of this report for each major.

#Conclusion


#Salary Box-and-Whisker Plots

```{r}
#source("boxPlotMaker.R")
```


![College of Agriculture](plots/boxAgriculture.png)

![College of Art & Design](plots/boxArtDesign.png)

![College of Business](plots/boxBusiness.png)

![College of Engineering](plots/boxEngineering.png)

![College of Humanities & Social Sciences](plots/boxHumanitiesSocialSciences.png)

![College of Human Sciences & Education](plots/boxHumanSciencesandEducation.png)

![College of Mass Communication](plots/boxMassCommunication.png)

![College of Music & Dramatic Arts](plots/boxMusicDramaticArts.png)

![College of Science](plots/boxScience.png)